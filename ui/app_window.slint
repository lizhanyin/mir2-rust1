// Library Editor ‰∏ªÁ™óÂè£
// Êñ∞Â∏ÉÂ±ÄÔºöÈ°∂ÈÉ®ËèúÂçïÊ†è + ‰∏≠Èó¥Â∑¶Âè≥ÂàÜÊ†è + Â∫ïÈÉ®Áº©Áï•Âõæ

export component AppWindow inherits Window {
    title: "Library Editor - Rust";
    width: 1200px;
    height: 800px;

    // Áä∂ÊÄÅÂ±ûÊÄß
    in-out property <string> status_text: "Â∞±Áª™";
    in-out property <string> file_name: "";
    in-out property <int> image_count: 0;
    in-out property <int> current_index: -1;

    // ÂõæÂÉè‰ø°ÊÅØ
    in-out property <int> image_width: 0;
    in-out property <int> image_height: 0;
    in-out property <string> image_format: "-";

    // ÂõûË∞É
    callback open_file();
    callback save_file();
    callback save_as_file();
    callback export_png();
    callback replace_image();
    callback prev_image();
    callback next_image();
    callback thumbnail_clicked(int);

    @children
    // ‰∏ªÂÆπÂô®
    Rectangle {
        background: #1e1e1e;

        VerticalLayout {
            spacing: 0px;

            // ========== È°∂ÈÉ®ËèúÂçïÊ†è ==========
            Rectangle {
                background: #2d2d2d;
                height: 28px;

                HorizontalLayout {
                    padding-left: 8px;
                    spacing: 4px;

                    // Êñá‰ª∂ËèúÂçï
                    Rectangle {
                        width: 60px;
                        height: 24px;

                        TouchArea {
                            mouse-cursor: pointer;
                            clicked => { root.open_file(); }

                            Rectangle {
                                background: #2d2d2d;
                                border-radius: 3px;

                                Text {
                                    text: "Êñá‰ª∂";
                                    color: #cccccc;
                                    font-size: 13px;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                }
                            }

                            // Hover ÊïàÊûúÈÄöËøá TouchArea ÁöÑÂ±ûÊÄßÂÆûÁé∞
                        }
                    }

                    // ÁºñËæëËèúÂçï
                    Rectangle {
                        width: 60px;
                        height: 24px;

                        Text {
                            text: "ÁºñËæë";
                            color: #cccccc;
                            font-size: 13px;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }

                    // ËßÜÂõæËèúÂçï
                    Rectangle {
                        width: 60px;
                        height: 24px;

                        Text {
                            text: "ËßÜÂõæ";
                            color: #cccccc;
                            font-size: 13px;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }

                    // Â∏ÆÂä©ËèúÂçï
                    Rectangle {
                        width: 60px;
                        height: 24px;

                        Text {
                            text: "Â∏ÆÂä©";
                            color: #cccccc;
                            font-size: 13px;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }

                    // ÂàÜÈöîÁ∫ø
                    Rectangle {
                        width: 1px;
                        background: #444;
                    }

                    // Âø´Êç∑Â∑•ÂÖ∑Ê†è
                    HorizontalLayout {
                        spacing: 4px;

                        // ÊâìÂºÄÊåâÈíÆ
                        TouchArea {
                            mouse-cursor: pointer;
                            clicked => { root.open_file(); }

                            Rectangle {
                                width: 24px;
                                height: 24px;
                                background: #2d2d2d;

                                Text {
                                    text: "üìÇ";
                                    font-size: 14px;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                }
                            }
                        }

                        // ‰øùÂ≠òÊåâÈíÆ
                        TouchArea {
                            mouse-cursor: pointer;
                            clicked => { root.save_file(); }

                            Rectangle {
                                width: 24px;
                                height: 24px;
                                background: #2d2d2d;

                                Text {
                                    text: "üíæ";
                                    font-size: 14px;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                }
                            }
                        }

                        // ÂØºÂá∫PNGÊåâÈíÆ
                        TouchArea {
                            mouse-cursor: pointer;
                            clicked => { root.export_png(); }

                            Rectangle {
                                width: 24px;
                                height: 24px;
                                background: #2d2d2d;

                                Text {
                                    text: "üì§";
                                    font-size: 14px;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                }
                            }
                        }
                    }

                    // Âè≥‰æßÂºπÊÄßÁ©∫Èó¥
                    Rectangle {}
                }
            }

            // ========== ‰∏≠Èó¥Âå∫ÂüüÔºöÂ∑¶Âè≥ÂàÜÊ†è ==========
            Rectangle {
                background: #1e1e1e;
                min-height: 400px;

                HorizontalLayout {
                    spacing: 0px;

                    // ========== Â∑¶‰æßÔºöÂ±ûÊÄßÊìç‰ΩúÈù¢Êùø ==========
                    Rectangle {
                        background: #252526;
                        width: 280px;

                        VerticalLayout {
                            spacing: 0px;

                            // Èù¢ÊùøÊ†áÈ¢ò
                            Rectangle {
                                background: #2d2d2d;
                                height: 32px;

                                Text {
                                    text: "Â±ûÊÄß‰∏éÊìç‰Ωú";
                                    color: #cccccc;
                                    font-size: 13px;
                                    font-weight: 600;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                }
                            }

                            // ÂÜÖÂÆπÂå∫Âüü
                            Rectangle {
                                VerticalLayout {
                                    padding: 16px;
                                    spacing: 16px;

                                    // === Êñá‰ª∂‰ø°ÊÅØÁªÑ ===
                                    VerticalLayout {
                                        spacing: 8px;

                                        Text {
                                            text: "Êñá‰ª∂‰ø°ÊÅØ";
                                            color: #858585;
                                            font-size: 11px;
                                            font-weight: 600;
                                        }

                                        VerticalLayout {
                                            spacing: 6px;
                                            padding-left: 8px;

                                            Text {
                                                text: "Êñá‰ª∂Âêç:";
                                                color: #858585;
                                                font-size: 12px;
                                            }

                                            Text {
                                                text: root.file_name == "" ? "Êú™Âä†ËΩΩ" : root.file_name;
                                                color: #cccccc;
                                                font-size: 12px;
                                                overflow: elide;
                                            }

                                            Text {
                                                text: "ÂõæÂÉèÊÄªÊï∞: " + root.image_count;
                                                color: #cccccc;
                                                font-size: 12px;
                                            }
                                        }
                                    }

                                    // ÂàÜÈöîÁ∫ø
                                    Rectangle {
                                        height: 1px;
                                        background: #3e3e42;
                                    }

                                    // === ÂΩìÂâçÂõæÂÉè‰ø°ÊÅØ ===
                                    VerticalLayout {
                                        spacing: 8px;

                                        Text {
                                            text: "ÂΩìÂâçÂõæÂÉè";
                                            color: #858585;
                                            font-size: 11px;
                                            font-weight: 600;
                                        }

                                        VerticalLayout {
                                            spacing: 6px;
                                            padding-left: 8px;

                                            HorizontalLayout {
                                                spacing: 8px;

                                                Text {
                                                    text: "Á¥¢Âºï:";
                                                    color: #858585;
                                                    font-size: 12px;
                                                    width: 50px;
                                                }

                                                Text {
                                                    text: root.current_index >= 0 ? root.current_index : "-";
                                                    color: #cccccc;
                                                    font-size: 12px;
                                                }
                                            }

                                            HorizontalLayout {
                                                spacing: 8px;

                                                Text {
                                                    text: "ÂÆΩÂ∫¶:";
                                                    color: #858585;
                                                    font-size: 12px;
                                                    width: 50px;
                                                }

                                                Text {
                                                    text: root.current_index >= 0 ? root.image_width : "-";
                                                    color: #cccccc;
                                                    font-size: 12px;
                                                }
                                            }

                                            HorizontalLayout {
                                                spacing: 8px;

                                                Text {
                                                    text: "È´òÂ∫¶:";
                                                    color: #858585;
                                                    font-size: 12px;
                                                    width: 50px;
                                                }

                                                Text {
                                                    text: root.current_index >= 0 ? root.image_height : "-";
                                                    color: #cccccc;
                                                    font-size: 12px;
                                                }
                                            }

                                            HorizontalLayout {
                                                spacing: 8px;

                                                Text {
                                                    text: "Ê†ºÂºè:";
                                                    color: #858585;
                                                    font-size: 12px;
                                                    width: 50px;
                                                }

                                                Text {
                                                    text: root.current_index >= 0 ? root.image_format : "-";
                                                    color: #cccccc;
                                                    font-size: 12px;
                                                }
                                            }
                                        }
                                    }

                                    // ÂàÜÈöîÁ∫ø
                                    Rectangle {
                                        height: 1px;
                                        background: #3e3e42;
                                    }

                                    // === Ë∞ÉËâ≤Êùø‰ø°ÊÅØ ===
                                    VerticalLayout {
                                        spacing: 8px;

                                        Text {
                                            text: "Ë∞ÉËâ≤Êùø";
                                            color: #858585;
                                            font-size: 11px;
                                            font-weight: 600;
                                        }

                                        VerticalLayout {
                                            spacing: 6px;
                                            padding-left: 8px;

                                            Text {
                                                text: "256 Ëâ≤";
                                                color: #cccccc;
                                                font-size: 12px;
                                            }

                                            Text {
                                                text: "ARGB 8888";
                                                color: #cccccc;
                                                font-size: 12px;
                                            }
                                        }
                                    }

                                    // ÂàÜÈöîÁ∫ø
                                    Rectangle {
                                        height: 1px;
                                        background: #3e3e42;
                                    }

                                    // === Êìç‰ΩúÊåâÈíÆ ===
                                    VerticalLayout {
                                        spacing: 8px;

                                        Text {
                                            text: "Êìç‰Ωú";
                                            color: #858585;
                                            font-size: 11px;
                                            font-weight: 600;
                                        }

                                        VerticalLayout {
                                            spacing: 8px;

                                            // ÂØºÂá∫PNGÊåâÈíÆ
                                            TouchArea {
                                                mouse-cursor: pointer;
                                                clicked => { root.export_png(); }

                                                Rectangle {
                                                    background: #0e639c;
                                                    border-radius: 4px;
                                                    height: 32px;

                                                    Text {
                                                        text: "ÂØºÂá∫ PNG";
                                                        color: #ffffff;
                                                        horizontal-alignment: center;
                                                        vertical-alignment: center;
                                                        font-size: 13px;
                                                        font-weight: 500;
                                                    }
                                                }
                                            }

                                            // ÊõøÊç¢ÂõæÂÉèÊåâÈíÆ
                                            TouchArea {
                                                mouse-cursor: pointer;
                                                clicked => { root.replace_image(); }

                                                Rectangle {
                                                    background: #3e3e42;
                                                    border-radius: 4px;
                                                    height: 32px;

                                                    Text {
                                                        text: "ÊõøÊç¢ÂõæÂÉè";
                                                        color: #cccccc;
                                                        horizontal-alignment: center;
                                                        vertical-alignment: center;
                                                        font-size: 13px;
                                                    }
                                                }
                                            }

                                            // ÂØºËà™ÊåâÈíÆ
                                            HorizontalLayout {
                                                spacing: 8px;

                                                TouchArea {
                                                    mouse-cursor: pointer;
                                                    clicked => { root.prev_image(); }

                                                    Rectangle {
                                                        background: root.current_index > 0 ? #0e639c : #3e3e42;
                                                        border-radius: 4px;
                                                        height: 32px;
                                                        width: 100px;

                                                        Text {
                                                            text: "‰∏ä‰∏ÄÂº†";
                                                            color: #ffffff;
                                                            horizontal-alignment: center;
                                                            vertical-alignment: center;
                                                            font-size: 13px;
                                                        }
                                                    }
                                                }

                                                TouchArea {
                                                    mouse-cursor: pointer;
                                                    clicked => { root.next_image(); }

                                                    Rectangle {
                                                        background: root.current_index < root.image_count - 1 ? #0e639c : #3e3e42;
                                                        border-radius: 4px;
                                                        height: 32px;
                                                        width: 100px;

                                                        Text {
                                                            text: "‰∏ã‰∏ÄÂº†";
                                                            color: #ffffff;
                                                            horizontal-alignment: center;
                                                            vertical-alignment: center;
                                                            font-size: 13px;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }

                    // ========== Âè≥‰æßÔºö‰∏ªÈ¢ÑËßàÂå∫Âüü ==========
                    Rectangle {
                        background: #1e1e1e;

                        VerticalLayout {
                            spacing: 0px;

                            // È¢ÑËßàÂå∫Ê†áÈ¢òÊ†è
                            Rectangle {
                                background: #2d2d2d;
                                height: 32px;

                                HorizontalLayout {
                                    padding: 12px;

                                    Text {
                                        text: "È¢ÑËßà";
                                        color: #cccccc;
                                        font-size: 13px;
                                        font-weight: 600;
                                        vertical-alignment: center;
                                    }

                                    Rectangle {}

                                    Text {
                                        text: root.current_index >= 0 ? "ÂõæÂÉè " + root.current_index + " / " + (root.image_count - 1) : "";
                                        color: #858585;
                                        font-size: 12px;
                                        vertical-alignment: center;
                                    }
                                }
                            }

                            // È¢ÑËßàÁîªÂ∏É
                            Rectangle {
                                background: #0c0c0c;

                                HorizontalLayout {
                                    alignment: center;

                                    Rectangle {
                                        width: 400px;
                                        height: 400px;
                                        background: #1e1e1e;
                                        border-width: 1px;
                                        border-color: #3e3e42;

                                        // ÊòæÁ§∫ÂõæÂÉèÊàñÂç†‰ΩçÁ¨¶
                                        if root.current_index >= 0 : Rectangle {
                                            background: #4ec9b0;

                                            Text {
                                                text: "È¢ÑËßàÂå∫Âüü\n" + "ÂõæÂÉè " + root.current_index;
                                                color: white;
                                                horizontal-alignment: center;
                                                vertical-alignment: center;
                                                font-size: 16px;
                                            }
                                        }

                                        if root.current_index < 0 : Rectangle {
                                            background: transparent;

                                            Text {
                                                text: "ËØ∑ÈÄâÊã©‰∏ÄÂº†ÂõæÂÉè";
                                                color: #666;
                                                horizontal-alignment: center;
                                                vertical-alignment: center;
                                                font-size: 14px;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            // ========== Â∫ïÈÉ®ÔºöÁº©Áï•ÂõæÂàóË°® ==========
            Rectangle {
                background: #252526;
                height: 140px;

                VerticalLayout {
                    spacing: 0px;

                    // Áº©Áï•ÂõæÊ†áÈ¢òÊ†è
                    Rectangle {
                        background: #2d2d2d;
                        height: 28px;

                        HorizontalLayout {
                            padding-left: 12px;
                            padding-right: 12px;
                            padding-top: 8px;
                            padding-bottom: 8px;

                            Text {
                                text: "Áº©Áï•Âõæ";
                                color: #cccccc;
                                font-size: 12px;
                                font-weight: 600;
                                vertical-alignment: center;
                            }

                            Rectangle {}

                            Text {
                                text: root.image_count + " Âº†ÂõæÂÉè";
                                color: #858585;
                                font-size: 11px;
                                vertical-alignment: center;
                            }
                        }
                    }

                    // Áº©Áï•ÂõæÊªöÂä®Âå∫Âüü
                    Rectangle {
                        background: #1e1e1e;

                        HorizontalLayout {
                            padding: 8px;
                            spacing: 4px;
                            alignment: center;

                            // Áº©Áï•ÂõæÂàóË°®
                            for i in root.image_count : Rectangle {
                                width: 80px;
                                height: 80px;
                                background: i == root.current_index ? #37373d : #2d2d2d;
                                border-width: i == root.current_index ? 2px : 1px;
                                border-color: i == root.current_index ? #007acc : #3e3e42;
                                border-radius: 4px;

                                TouchArea {
                                    mouse-cursor: pointer;
                                    clicked => { root.thumbnail_clicked(i); }
                                }

                                VerticalLayout {
                                    spacing: 4px;
                                    padding: 4px;

                                    // Áº©Áï•ÂõæÈ¢ÑËßà
                                    Rectangle {
                                        width: 48px;
                                        height: 48px;
                                        background: #4ec9b0;
                                        border-radius: 2px;

                                        HorizontalLayout {
                                            alignment: center;

                                            Text {
                                                text: i;
                                                color: white;
                                                font-size: 14px;
                                                font-weight: 600;
                                            }
                                        }
                                    }

                                    // Áº©Áï•ÂõæÁ¥¢Âºï
                                    Text {
                                        text: "#" + i;
                                        color: #cccccc;
                                        font-size: 11px;
                                        horizontal-alignment: center;
                                    }
                                }
                            }

                            // Á©∫Áä∂ÊÄÅ
                            if root.image_count == 0 : Rectangle {
                                width: 100%;
                                height: 100%;

                                Text {
                                    text: "ÊöÇÊó†ÂõæÂÉè";
                                    color: #666;
                                    horizontal-alignment: center;
                                    vertical-alignment: center;
                                    font-size: 13px;
                                }
                            }
                        }
                    }
                }
            }

            // ========== Â∫ïÈÉ®Áä∂ÊÄÅÊ†è ==========
            Rectangle {
                background: #007acc;
                height: 22px;

                HorizontalLayout {
                    padding-left: 12px;
                    padding-right: 12px;
                    padding-top: 6px;
                    padding-bottom: 6px;

                    Text {
                        text: root.status_text;
                        color: #ffffff;
                        font-size: 11px;
                        vertical-alignment: center;
                    }

                    Rectangle {}

                    Text {
                        text: "Library Editor v1.0";
                        color: #ffffff;
                        font-size: 10px;
                        opacity: 0.7;
                        vertical-alignment: center;
                    }
                }
            }
        }
    }
}
